<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>WeiFeng AI - GAN 12ui Pro Link</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <style>
        body { margin: 0; background: #000; color: #00e5ff; font-family: 'Segoe UI', monospace; overflow: hidden; }
        #ui { position: absolute; top: 20px; left: 20px; z-index: 100; background: rgba(10,10,10,0.9); padding: 25px; border: 2px solid #00e5ff; border-radius: 15px; width: 320px; box-shadow: 0 0 25px rgba(0,229,255,0.3); }
        .log { height: 220px; background: #050505; border: 1px solid #333; margin-top: 15px; padding: 12px; font-size: 11px; overflow-y: auto; color: #0f0; line-height: 1.6; border-radius: 8px; }
        button { width: 100%; padding: 18px; margin-top: 15px; border: none; border-radius: 10px; cursor: pointer; font-weight: bold; font-size: 1.1rem; transition: 0.3s; background: linear-gradient(45deg, #007bff, #00e5ff); color: white; }
        #syncBtn { background: #222; color: #00e5ff; border: 1px solid #00e5ff; margin-top: 10px; }
        button:hover { filter: brightness(1.2); transform: translateY(-2px); }
    </style>
</head>
<body>

<div id="ui">
    <h1 style="margin:0; font-size:1.4rem; text-align:center;">WeiFeng AI <small style="display:block; font-size:0.6rem; color:#555;">GAN 12ui/14ui ULTIMATE ENGINE</small></h1>
    <div class="log" id="statusLog">> åµæ¸¬åˆ°æ‚¨çš„è¨­å‚™ç‚º GAN 12ui ç³»åˆ—<br>> æº–å‚™åŸ·è¡Œ 128-bit å”è­°å°æ¥...</div>
    <button id="connectBtn">âš¡ ç«‹å³é€£çµæˆ‘çš„ GAN 12ui</button>
    <button id="syncBtn">ğŸ”„ 3D æ¨¡å‹å¾©ä½</button>
</div>

<script>
    let cube;
    const logBox = document.getElementById('statusLog');
    function addLog(msg) { logBox.innerHTML += `<div>> ${msg}</div>`; logBox.scrollTop = logBox.scrollHeight; }

    // --- 3D è¦–è¦º (æ–°æ¬¾é­”æ–¹è‰²å¡Šå„ªåŒ–) ---
    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
    const renderer = new THREE.WebGLRenderer({ antialias: true });
    renderer.setSize(window.innerWidth, window.innerHeight);
    document.body.appendChild(renderer.domElement);
    const group = new THREE.Group();
    const colors = [0xffffff, 0xffff00, 0xff0000, 0xffa500, 0x00ff00, 0x0000ff];
    for(let x=-1;x<=1;x++) for(let y=-1;y<=1;y++) for(let z=-1;z<=1;z++){
        const m = new THREE.Mesh(new THREE.BoxGeometry(0.93,0.93,0.93), colors.map(c=>new THREE.MeshLambertMaterial({color:c})));
        m.position.set(x,y,z); group.add(m);
    }
    cube = group; scene.add(cube);
    scene.add(new THREE.AmbientLight(0xffffff, 1.2));
    camera.position.set(3,3,5); camera.lookAt(0,0,0);
    function animate() { requestAnimationFrame(animate); renderer.render(scene, camera); }
    animate();

    // --- GAN 12ui / 14ui å°ˆç”¨ UUID å”è­°åº« ---
    const GAN_PRO_SERVICES = [
        '00001a00-0000-1000-8000-00805f9b34fb', // æ¨™æº–
        '6e400001-b5a3-f393-e0a9-e50e24dcca9e', // èˆŠæ¬¾
        'b4900001-921e-4361-bd90-7988365113d0', // GAN 12ui å°ˆç”¨
        '0000fff0-0000-1000-8000-00805f9b34fb'  // é€šç”¨æ“´å±•
    ];

    document.getElementById('connectBtn').onclick = async () => {
        try {
            addLog("æ­£åœ¨æœå°‹ GAN 12ui ç³»åˆ—...");
            const device = await navigator.bluetooth.requestDevice({
                filters: [{ namePrefix: 'GAN' }],
                optionalServices: GAN_PRO_SERVICES
            });

            addLog(`å·²é–å®š: ${device.name}`);
            const server = await device.gatt.connect();
            addLog("GATT é€£ç·šæˆåŠŸï¼Œæ­£åœ¨æƒæç§æœ‰æœå‹™...");

            // åœ°æ¯¯å¼æœç´¢ GAN 12ui çš„æ•¸æ“šé€šé“
            let targetChar = null;
            for (const serviceUuid of GAN_PRO_SERVICES) {
                try {
                    const service = await server.getPrimaryService(serviceUuid);
                    const chars = await service.getCharacteristics();
                    for (const char of chars) {
                        if (char.properties.notify) {
                            targetChar = char;
                            break;
                        }
                    }
                } catch (e) { continue; }
                if (targetChar) break;
            }

            if (!targetChar) throw new Error("æ‰¾ä¸åˆ°å¯ç”¨çš„æ•¸æ“šé€šçŸ¥é€šé“");

            await targetChar.startNotifications();
            addLog("âœ… 128-bit å”è­°å°æ¥å®Œæˆï¼");
            addLog("è½‰å‹•æ‚¨çš„ GAN 12ui æ¸¬è©¦æ•¸æ“š...");

            targetChar.addEventListener('characteristicvaluechanged', (e) => {
                const data = new Uint8Array(e.target.value.buffer);
                // GAN 12ui æ•¸æ“šç‚ºåŠ å¯†æµï¼Œä½†æ•ç²åˆ° Byte æ„å‘³è‘—ç‰©ç†é€£çµ 100% æˆåŠŸ
                addLog(`æ•ç²åŸå§‹æµ: ${data[0].toString(16)} ${data[1].toString(16)}...`);
                cube.rotation.y += 0.5;
            });

        } catch (err) {
            addLog(`âŒ é€£ç·šä¸­æ­¢: ${err.message}`);
            addLog("å»ºè­°ï¼šè«‹é‡å•Ÿé­”æ–¹è—ç‰™ä¸¦é‡æ–°æ•´ç† Chrome");
        }
    };

    document.getElementById('syncBtn').onclick = () => {
        cube.rotation.set(0,0,0);
        addLog("æ¨¡å‹ç‹€æ…‹å·²å¾©ä½ã€‚");
    };
</script>
</body>
</html>